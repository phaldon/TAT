<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TAT: include/TAT/tensor.hpp 源文件</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TAT
   &#160;<span id="projectnumber">v0.1.0-rc.11</span>
   </div>
   <div id="projectbrief">TAT is A Tensor library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tensor_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">tensor.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tensor_8hpp.html">浏览该文件的文档.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifndef TAT_TENSOR_HPP</span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="tensor_8hpp.html#aad98d87f1a7f9d311598c6ee13a21347">   22</a></span>&#160;<span class="preprocessor">#define TAT_TENSOR_HPP</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="basic__type_8hpp.html">basic_type.hpp</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="core_8hpp.html">core.hpp</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="edge_8hpp.html">edge.hpp</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="name_8hpp.html">name.hpp</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="symmetry_8hpp.html">symmetry.hpp</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceTAT.html">TAT</a> {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keyword">struct </span>mpi_t;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType = <span class="keywordtype">double</span>, <span class="keyword">typename</span> Symmetry = NoSymmetry, <span class="keyword">typename</span> Name = DefaultName&gt;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html">   51</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="structTAT_1_1Singular.html">Singular</a> {</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">   52</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">normal_map</a> = std::map&lt;Symmetry, vector&lt;real_base_t&lt;ScalarType&gt;&gt;&gt;;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a251207a171aed3995dda904fec5528f6">   53</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1fake__map.html">fake_singular_map</a> = <a class="code" href="structTAT_1_1fake__map.html">fake_map&lt;Symmetry, vector&lt;real_base_t&lt;ScalarType&gt;</a>&gt;&gt;;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#ifdef TAT_USE_SIMPLE_NOSYMMETRY</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">singular_map</a> = std::conditional_t&lt;std::is_same_v&lt;Symmetry, NoSymmetry&gt;, <a class="code" href="structTAT_1_1Singular.html#a251207a171aed3995dda904fec5528f6">fake_singular_map</a>, <a class="code" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">normal_map</a>&gt;;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">   57</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">singular_map</a> = <a class="code" href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">normal_map</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">   59</a></span>&#160;      <a class="code" href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">singular_map</a> <a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> p&gt;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a17de08d8837e04b110ae0d6ea2a90676">   62</a></span>&#160;      [[nodiscard]] <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> <a class="code" href="structTAT_1_1Singular.html#a17de08d8837e04b110ae0d6ea2a90676">norm</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="keywordflow">if</span> constexpr (p == -1) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> maximum = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [symmetry, singulars] : <a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; element : singulars) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                  <span class="keyword">auto</span> absolute = std::abs(element);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                  maximum = maximum &lt; absolute ? absolute : maximum;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;               }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span> maximum;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (p == 1) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> summation = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [symmetry, singulars] : <a class="code" href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">value</a>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; element : singulars) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                  <span class="keyword">auto</span> absolute = std::abs(element);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                  summation += absolute;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;               }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">return</span> summation;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga40f46f83982bd27a7e204d8a1360b6a0">TAT_error</a>(<span class="stringliteral">&quot;Not Implement For Singulars Normalize Kind, Only +1 and -1 supported now&quot;</span>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#gaa69be631b50d82c02164fe90977565b0">show</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#ga020c0be4a859687755aeef9b910d5c1b">dump</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Singular.html#a1acbadd2866fc14ef81b549cd25b2686">load</a>(<span class="keyword">const</span> std::string&amp;) &amp;;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structTAT_1_1Singular.html#a92fcbf9f6877a19832fa15b38af050e4">   90</a></span>&#160;      <a class="code" href="structTAT_1_1Singular.html">Singular&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Singular.html#a92fcbf9f6877a19832fa15b38af050e4">load</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">string</span>) &amp;&amp; {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Singular.html#a1acbadd2866fc14ef81b549cd25b2686">load</a>(<span class="keywordtype">string</span>));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      };</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   };</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType = <span class="keywordtype">double</span>, <span class="keyword">typename</span> Symmetry = NoSymmetry, <span class="keyword">typename</span> Name = DefaultName&gt;</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html">  114</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="structTAT_1_1Tensor.html">Tensor</a> {</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a9cc15c9afe143966029c1d0dc8fa6f91">  115</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a9cc15c9afe143966029c1d0dc8fa6f91">scalar_valid</a> = std::enable_if_t&lt;is_scalar_v&lt;ScalarType&gt;&gt;;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a04b37643797ad7da56f258c2996a4135">  116</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a04b37643797ad7da56f258c2996a4135">symmetry_valid</a> = std::enable_if_t&lt;is_symmetry_v&lt;Symmetry&gt;&gt;;</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a529084aace9257dd27b0b61bde589888">  117</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a529084aace9257dd27b0b61bde589888">name_valid</a> = std::enable_if_t&lt;is_name_v&lt;Name&gt;&gt;;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="comment">// TODO: private访问控制</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">  124</a></span>&#160;      std::vector&lt;Name&gt; <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">  129</a></span>&#160;      std::map&lt;Name, Rank&gt; <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">  135</a></span>&#160;      std::shared_ptr&lt;Core&lt;ScalarType, Symmetry&gt;&gt; <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a249f71a6068ebf0932c6566e18c3e11b">  144</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a249f71a6068ebf0932c6566e18c3e11b">Tensor</a>(std::vector&lt;Name&gt; names_init, std::vector&lt;<a class="code" href="structTAT_1_1Edge.html">Edge&lt;Symmetry&gt;</a>&gt; edges_init, <span class="keyword">const</span> <span class="keywordtype">bool</span> auto_reverse = <span class="keyword">false</span>) :</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>(std::move(names_init)),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>(construct_name_to_index(<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>)),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>(std::make_shared&lt;<a class="code" href="structTAT_1_1Core.html">Core</a>&lt;ScalarType, Symmetry&gt;&gt;(std::move(edges_init), auto_reverse)) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         check_valid_name(<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>, <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;edges.size());</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Int = Size, <span class="keyword">typename</span> = std::enable_if_t&lt;std::is_same_v&lt;Symmetry, NoSymmetry&gt; &amp;&amp; !std::is_same_v&lt;Int, Edge&lt;Symmetry&gt;&gt;&gt;&gt;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a7a99ba8f4a7a6a7e1185b6fac04cbb58">  152</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a7a99ba8f4a7a6a7e1185b6fac04cbb58">Tensor</a>(std::vector&lt;Name&gt; names_init, <span class="keyword">const</span> std::vector&lt;Int&gt;&amp; edges_init) :</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html">Tensor</a>(std::move(names_init), {edges_init.begin(), edges_init.end()}) {}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> NameType, <span class="keyword">typename</span> EdgeType, <span class="keyword">typename</span> = std::enable_if_t&lt;!std::is_same_v&lt;NameType, Name&gt;&gt;&gt;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            std::vector&lt;NameType&gt;&amp;&amp; names_init,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            std::vector&lt;EdgeType&gt;&amp;&amp; edges_init,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> auto_reverse = <span class="keyword">false</span>) :</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>({names_init.begin(), names_init.end()}, {edges_init.begin(), edges_init.end()}, auto_reverse) {}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a9d94cc5a258afdf3b256779df8a8bd9b">  169</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a9d94cc5a258afdf3b256779df8a8bd9b">copy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> result;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         result.<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a> = <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         result.<a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a> = <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         result.<a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a> = std::make_shared&lt;Core&lt;ScalarType, Symmetry&gt;&gt;(*core);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a67773ad17527d10e1129478340cda72e">  177</a></span>&#160;      [[nodiscard]] <span class="keywordtype">bool</span> <a class="code" href="structTAT_1_1Tensor.html#a67773ad17527d10e1129478340cda72e">is_valid</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;         <span class="keywordflow">return</span> bool(<a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#ifdef TAT_USE_VALID_DEFAULT_TENSOR</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>() : <a class="code" href="structTAT_1_1Tensor.html">Tensor</a>(1){};</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; other) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(<a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp;&amp; other) noexcept = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a2e1ca6a58056b952a50e3238ba2a533c">operator=</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; other) = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a2e1ca6a58056b952a50e3238ba2a533c">operator=</a>(<a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>&amp;&amp; other) noexcept = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a1d423525b08fa4b1624435798c2be80d">~Tensor</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a4804ab139acbaa19d5efb0b033653e71">  196</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a4804ab139acbaa19d5efb0b033653e71">Tensor</a>(ScalarType number) : <a class="code" href="structTAT_1_1Tensor.html">Tensor</a>({}, {}) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks.begin()-&gt;second.front() = number;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      [[nodiscard]] <span class="keyword">static</span> Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a24856542d03837f09da3a2f2efd78c67">  208</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a24856542d03837f09da3a2f2efd78c67">one</a>(ScalarType number,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          std::vector&lt;Name&gt; names_init,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="keyword">const</span> std::vector&lt;Symmetry&gt;&amp; edge_symmetry = {},</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keyword">const</span> std::vector&lt;Arrow&gt;&amp; edge_arrow = {}) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;         <span class="keyword">auto</span> rank = names_init.size();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;         <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">Tensor</a>(std::move(names_init), get_edge_from_edge_symmetry_and_arrow(edge_symmetry, edge_arrow, rank));</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         result.core-&gt;blocks.begin()-&gt;second.front() = number;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">  218</a></span>&#160;      [[nodiscard]] <span class="keywordtype">bool</span> <a class="code" href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">is_scalar</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks.size() == 1 &amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks.begin()-&gt;second.size() == 1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ab836bd75946c187a1cc2acbaf1921cb6">  225</a></span>&#160;      <span class="keyword">operator</span> ScalarType()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">is_scalar</a>()) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="group__Miscellaneous.html#ga40f46f83982bd27a7e204d8a1360b6a0">TAT_error</a>(<span class="stringliteral">&quot;Try to get the only element of the tensor which contains more than one element&quot;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;         }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks.begin()-&gt;second.front();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#afaf08baeb2eed70e2f64e7af12dfeb8a">  232</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#afaf08baeb2eed70e2f64e7af12dfeb8a">EdgeInfoForGetItem</a> = std::conditional_t&lt;std::is_same_v&lt;Symmetry, NoSymmetry&gt;, <a class="code" href="group__Miscellaneous.html#gac705eedd6237ac6373746e8d473fef14">Size</a>, std::tuple&lt;Symmetry, Size&gt;&gt;;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#ac499e258364f1d6fe53b081cf837648b">EdgeInfoWithArrowForExpand</a> = std::conditional_t&lt;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            std::is_same_v&lt;Symmetry, NoSymmetry&gt;,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            std::tuple&lt;Size, Size&gt;,</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ac499e258364f1d6fe53b081cf837648b">  236</a></span>&#160;            std::conditional_t&lt;is_fermi_symmetry_v&lt;Symmetry&gt;, std::tuple&lt;Arrow, Symmetry, Size, Size&gt;, std::tuple&lt;Symmetry, Size, Size&gt;&gt;&gt;;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#acad907b1894ad6b0e54b92e3c2f28574">expand</a>(<span class="keyword">const</span> std::map&lt;Name, EdgeInfoWithArrowForExpand&gt;&amp; configure, <span class="keyword">const</span> Name&amp; old_name = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::No_Old_Name</a>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a626e84e32ab8019597c60ada6f9a45ea">shrink</a>(<span class="keyword">const</span> std::map&lt;Name, EdgeInfoForGetItem&gt;&amp; configure, <span class="keyword">const</span> Name&amp; new_name = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::No_New_Name</a>, <a class="code" href="group__Miscellaneous.html#ga78326bee7cc963cd2d165718de5c0465">Arrow</a> arrow = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Use shrink instead&quot;</span>)]] [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ace1791bdc2285cf186be58d30d7c9f42">  245</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ace1791bdc2285cf186be58d30d7c9f42">slice</a>(<span class="keyword">const</span> std::map&lt;Name, EdgeInfoForGetItem&gt;&amp; configure, <span class="keyword">const</span> Name&amp; new_name = <a class="code" href="structTAT_1_1InternalName.html">InternalName&lt;Name&gt;::No_New_Name</a>, <a class="code" href="group__Miscellaneous.html#ga78326bee7cc963cd2d165718de5c0465">Arrow</a> arrow = <span class="keyword">false</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a626e84e32ab8019597c60ada6f9a45ea">shrink</a>(configure, new_name, arrow);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">  253</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">same_shape</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>(<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>, <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;edges);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Transform&gt;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#aa6b84a6f099ca0193a0ad6e9e8e04415">  264</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#aa6b84a6f099ca0193a0ad6e9e8e04415">map</a>(Transform&amp;&amp; <span class="keyword">function</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">same_shape</a>();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [symmetries, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            std::transform(<a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.begin(), <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.end(), result.core-&gt;blocks.at(symmetries).begin(), <span class="keyword">function</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Transform&gt;</div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#acba0ec0802ec95a255a99bc42d94dd1f">  280</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#acba0ec0802ec95a255a99bc42d94dd1f">transform</a>(Transform&amp;&amp; <span class="keyword">function</span>) &amp; {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>.use_count() != 1) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a> = std::make_shared&lt;Core&lt;ScalarType, Symmetry&gt;&gt;(*core);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            TAT_warning_or_error_when_inplace_transform(<span class="stringliteral">&quot;Set Tensor Shared, Copy Data Happened Here&quot;</span>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            std::transform(<a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.begin(), <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.end(), <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.begin(), <span class="keyword">function</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Transform&gt;</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a9cf93a852d354ee03e3ae33e278ec396">  291</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#a9cf93a852d354ee03e3ae33e278ec396">transform</a>(Transform&amp;&amp; <span class="keyword">function</span>) &amp;&amp; {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#acba0ec0802ec95a255a99bc42d94dd1f">transform</a>(<span class="keyword">function</span>));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Generator&gt;</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">  302</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>(Generator&amp;&amp; generator) &amp; {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;         <a class="code" href="structTAT_1_1Tensor.html#acba0ec0802ec95a255a99bc42d94dd1f">transform</a>([&amp;](ScalarType _) { <span class="keywordflow">return</span> generator(); });</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Generator&gt;</div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a2c908557416bb3b3c72896320aa30106">  307</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#a2c908557416bb3b3c72896320aa30106">set</a>(Generator&amp;&amp; generator) &amp;&amp; {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>(generator));</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">  316</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">zero</a>() &amp; {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>([]() { <span class="keywordflow">return</span> 0; });</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      }</div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ae63a2323a01a71dda38b8856cb5a532b">  319</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#ae63a2323a01a71dda38b8856cb5a532b">zero</a>() &amp;&amp; {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">zero</a>());</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">  328</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">test</a>(ScalarType first = 0, ScalarType step = 1) &amp; {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">set</a>([&amp;first, step]() {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keyword">auto</span> result = first;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            first += step;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         });</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      }</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a0fe4f7437b71de7367ca2623a2111aaa">  335</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#a0fe4f7437b71de7367ca2623a2111aaa">test</a>(ScalarType first = 0, ScalarType step = 1) &amp;&amp; {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">test</a>(first, step));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">  345</a></span>&#160;      [[nodiscard]] <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>(<span class="keyword">const</span> std::map&lt;Name, Symmetry&gt;&amp; position = {}) <span class="keyword">const</span>&amp; {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a24d53d8dd85af8c4a0ee21fbc8dd6b41">const_block</a>(position);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      [[nodiscard]] <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>(<span class="keyword">const</span> std::map&lt;Name, Symmetry&gt;&amp; position = {}) &amp;;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      [[nodiscard]] <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#a24d53d8dd85af8c4a0ee21fbc8dd6b41">const_block</a>(<span class="keyword">const</span> std::map&lt;Name, Symmetry&gt;&amp; position = {}) <span class="keyword">const</span>&amp;;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Position&gt;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>(Position&amp;&amp; position) <span class="keyword">const</span>&amp; {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>({position.begin(), position.end()});</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Position&gt;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] <span class="keyword">auto</span>&amp; <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>(Position&amp;&amp; position) &amp; {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>({position.begin(), position.end()});</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">  370</a></span>&#160;      [[nodiscard]] <span class="keyword">const</span> ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">at</a>(<span class="keyword">const</span> std::map&lt;Name, EdgeInfoForGetItem&gt;&amp; position) <span class="keyword">const</span>&amp; {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a4cebe372f267460b8d0a558e2db7139a">const_at</a>(position);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      [[nodiscard]] ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">at</a>(<span class="keyword">const</span> std::map&lt;Name, EdgeInfoForGetItem&gt;&amp; position) &amp;;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      [[nodiscard]] <span class="keyword">const</span> ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#a4cebe372f267460b8d0a558e2db7139a">const_at</a>(<span class="keyword">const</span> std::map&lt;Name, EdgeInfoForGetItem&gt;&amp; position) <span class="keyword">const</span>&amp;;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Position&gt;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] ScalarType <a class="code" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">at</a>(Position&amp;&amp; position) <span class="keyword">const</span>&amp; {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">at</a>({position.begin(), position.end()});</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Position&gt;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] ScalarType&amp; <a class="code" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">at</a>(Position&amp;&amp; position) &amp; {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">at</a>({position.begin(), position.end()});</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalarType, <span class="keyword">typename</span> = std::enable_if_t&lt;is_scalar_v&lt;OtherScalarType&gt;&gt;&gt;</div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ab102bd3898b58fff24b10ed07f3221e6">  396</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;OtherScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ab102bd3898b58fff24b10ed07f3221e6">to</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ScalarType, OtherScalarType&gt;) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>{};</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            result.<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a> = <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            result.name_to_index = <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            result.core = <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keyword">auto</span> result = <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;OtherScalarType, Symmetry, Name&gt;</a>{};</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            result.<a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a> = <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            result.name_to_index = <a class="code" href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">name_to_index</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            result.core = std::make_shared&lt;Core&lt;OtherScalarType, Symmetry&gt;&gt;();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            result.core-&gt;edges = <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;edges;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [symmetries, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;               <span class="keyword">auto</span> [iterator, success] = result.core-&gt;blocks.emplace(symmetries, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.size());</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;               <span class="keyword">auto</span>&amp; this_block = iterator-&gt;second;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;               <span class="keywordflow">for</span> (<a class="code" href="group__Miscellaneous.html#gac50ae59af1a35e2ecec08941c3d1115d">Nums</a> i = 0; i &lt; <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.size(); i++) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                  <span class="keywordflow">if</span> constexpr (is_complex_v&lt;ScalarType&gt; &amp;&amp; is_real_v&lt;OtherScalarType&gt;) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                     this_block[i] = OtherScalarType(<a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>[i].real());</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                     this_block[i] = OtherScalarType(<a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>[i]);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                  }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;               }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> p = 2&gt;</div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a6cb81dfbd5808d32766b0acf5a60a9aa">  430</a></span>&#160;      [[nodiscard]] <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a6cb81dfbd5808d32766b0acf5a60a9aa">norm</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a> result = 0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         <span class="keywordflow">if</span> constexpr (p == -1) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; number : <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                  <span class="keywordflow">if</span> (<span class="keyword">auto</span> absolute_value = std::abs(number); absolute_value &gt; result) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                     result = absolute_value;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                  }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;               }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (p == 0) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;               result += <a class="code" href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">real_base_t&lt;ScalarType&gt;</a>(<a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>.size());</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_, <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>] : <a class="code" href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">core</a>-&gt;blocks) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; number : <a class="code" href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">block</a>) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                  <span class="keywordflow">if</span> constexpr (p == 1) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                     result += std::abs(number);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> constexpr (p == 2) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                     result += std::norm(number);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                     <span class="keywordflow">if</span> constexpr (p % 2 == 0 &amp;&amp; is_real_v&lt;ScalarType&gt;) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                        result += std::pow(number, p);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                     } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        result += std::pow(std::abs(number), p);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                     }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                  }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;               }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            result = std::pow(result, 1. / p);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;         }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;         <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a1eb633a8b129a8c1f2b2b0caf5659815">  465</a></span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a1eb633a8b129a8c1f2b2b0caf5659815">MapIteratorList</a> = std::vector&lt;typename Edge&lt;Symmetry&gt;::edge_map::const_iterator&gt;;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keyword">template</span>&lt;<span class="keywordtype">bool</span> split_edge_is_po<span class="keywordtype">int</span>er = false&gt;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a4df7b1315f2abd7065ef9f2053ee9a7a">edge_operator</a>(</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keyword">const</span> std::map&lt;Name, Name&gt;&amp; rename_map,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keyword">const</span> std::map&lt;Name, std::vector&lt;std::tuple&lt;Name, <a class="code" href="structTAT_1_1BoseEdge.html">BoseEdge&lt;Symmetry, split_edge_is_pointer&gt;</a>&gt;&gt;&gt;&amp; split_map,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keyword">const</span> std::set&lt;Name&gt;&amp; reversed_name,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keyword">const</span> std::map&lt;Name, std::vector&lt;Name&gt;&gt;&amp; merge_map,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            std::vector&lt;Name&gt; new_names,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keyword">const</span> std::array&lt;std::set&lt;Name&gt;, 4&gt;&amp; parity_exclude_name = {{{}, {}, {}, {}}},</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keyword">const</span> std::map&lt;Name, std::map&lt;Symmetry, Size&gt;&gt;&amp; edge_and_symmetries_to_cut_before_all = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ad8f4ac89efc12b4afdfbe6fb12cb781b">edge_rename</a>(<span class="keyword">const</span> std::map&lt;Name, Name&gt;&amp; dictionary) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#a439e664b9580d6514c65f7f866f288d2">transpose</a>(std::vector&lt;Name&gt; target_names) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#abbe401ff6d00b18a4e110e4e6b8aa3aa">reverse_edge</a>(<span class="keyword">const</span> std::set&lt;Name&gt;&amp; reversed_name, <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>, <span class="keyword">const</span> std::set&lt;Name&gt;&amp; parity_exclude_name = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ae7c9939fc28077a7aaabc7da37aeab66">merge_edge</a>(</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            std::map&lt;Name, std::vector&lt;Name&gt;&gt; merge,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keyword">const</span> std::set&lt;Name&gt;&amp; parity_exclude_name_merge = {},</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keyword">const</span> std::set&lt;Name&gt;&amp; parity_exclude_name_reverse = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ab2c9d5865a9866a31a44db38b6aaf5b8">split_edge</a>(</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            std::map&lt;Name, std::vector&lt;std::tuple&lt;Name, BoseEdge&lt;Symmetry&gt;&gt;&gt;&gt; split,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordtype">bool</span> apply_parity = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="keyword">const</span> std::set&lt;Name&gt;&amp; parity_exclude_name_split = {}) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="comment">// 可以考虑不转置成矩阵直接乘积的可能, 但这个最多优化N^2的常数次, 只需要转置不调用多次就不会产生太大的问题</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span>      [[nodiscard]] <span class="keyword">static</span> Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keyword">const</span> Tensor&lt;ScalarType, Symmetry, Name&gt;&amp; tensor_1,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="keyword">const</span> Tensor&lt;ScalarType, Symmetry, Name&gt;&amp; tensor_2,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            std::set&lt;std::tuple&lt;Name, Name&gt;&gt; contract_names);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType1, <span class="keyword">typename</span> ScalarType2&gt;</div>
<div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#afe3ee11efb23ff4d93e6a565d607cbfe">  559</a></span>&#160;      [[nodiscard]] <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code" href="structTAT_1_1Tensor.html#afe3ee11efb23ff4d93e6a565d607cbfe">contract</a>(</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType1, Symmetry, Name&gt;</a>&amp; tensor_1,</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType2, Symmetry, Name&gt;</a>&amp; tensor_2,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            std::set&lt;std::tuple&lt;Name, Name&gt;&gt; contract_names) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         <span class="keyword">using</span> ResultScalarType = std::common_type_t&lt;ScalarType1, ScalarType2&gt;;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         <span class="keyword">using</span> ResultTensor = <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ResultScalarType, Symmetry, Name&gt;</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ResultScalarType, ScalarType1&gt;) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ResultScalarType, ScalarType2&gt;) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(tensor_1, tensor_2, std::move(contract_names));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(tensor_1, tensor_2.template to&lt;ResultScalarType&gt;(), std::move(contract_names));</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;ResultScalarType, ScalarType2&gt;) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(tensor_1.template to&lt;ResultScalarType&gt;(), tensor_2, std::move(contract_names));</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;               <span class="keywordflow">return</span> ResultTensor::contract(</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                     tensor_1.template to&lt;ResultScalarType&gt;(), tensor_2.template to&lt;ResultScalarType&gt;(), std::move(contract_names));</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;         }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalarType&gt;</div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a246a14a49fc37102d2b184d4cc08c11b">  582</a></span>&#160;      [[nodiscard]] <span class="keyword">auto</span> <a class="code" href="structTAT_1_1Tensor.html#a246a14a49fc37102d2b184d4cc08c11b">contract</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;OtherScalarType, Symmetry, Name&gt;</a>&amp; tensor_2, std::set&lt;std::tuple&lt;Name, Name&gt;&gt; contract_names)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(*<span class="keyword">this</span>, tensor_2, std::move(contract_names));</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType1, <span class="keyword">typename</span> ScalarType2, <span class="keyword">typename</span> PairSet&gt;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] <span class="keyword">static</span> <span class="keyword">auto</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType1, Symmetry, Name&gt;</a>&amp; tensor_1, <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType2, Symmetry, Name&gt;</a>&amp; tensor_2, PairSet&amp;&amp; contract_names) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(tensor_1, tensor_2, {contract_names.begin(), contract_names.end()});</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      };</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> OtherScalarType, <span class="keyword">typename</span> PairSet&gt;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] <span class="keyword">auto</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(<span class="keyword">const</span> Tensor&lt;OtherScalarType, Symmetry, Name&gt;&amp; tensor_2, PairSet&amp;&amp; contract_names)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(*<span class="keyword">this</span>, tensor_2, {contract_names.begin(), contract_names.end()});</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a99633cbb2776da691ad804a23f8e7d99">  605</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a99633cbb2776da691ad804a23f8e7d99">contract_all_edge</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; other)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         <span class="comment">// other不含有的边会在contract中自动删除</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         <span class="keyword">auto</span> contract_names = std::set&lt;std::tuple&lt;Name, Name&gt;&gt;();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; i : <a class="code" href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">names</a>) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            contract_names.insert({i, i});</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">contract</a>(other, contract_names);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">  618</a></span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">contract_all_edge</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">contract_all_edge</a>(<a class="code" href="structTAT_1_1Tensor.html#ab1e8b48602667685790b72681050af1c">conjugate</a>());</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a5065992828c0a3cb6b8358ea0adbd4fc">identity</a>(<span class="keyword">const</span> std::set&lt;std::tuple&lt;Name, Name&gt;&gt;&amp; pairs) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> PairSet&gt;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a5065992828c0a3cb6b8358ea0adbd4fc">identity</a>(PairSet&amp;&amp; pairs)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a5065992828c0a3cb6b8358ea0adbd4fc">identity</a>({pairs.begin(), pairs.end()});</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#af2f426b740f06990a2decc2213413de5">exponential</a>(<span class="keyword">const</span> std::set&lt;std::tuple&lt;Name, Name&gt;&gt;&amp; pairs, <span class="keywordtype">int</span> step = 2) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> PairSet&gt;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#af2f426b740f06990a2decc2213413de5">exponential</a>(PairSet&amp;&amp; pairs, <span class="keywordtype">int</span> step = 2)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#af2f426b740f06990a2decc2213413de5">exponential</a>({pairs.begin(), pairs.end()}, step);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ab1e8b48602667685790b72681050af1c">conjugate</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#a0a076f5dddae84960769976d67e136b8">trace</a>(<span class="keyword">const</span> std::set&lt;std::tuple&lt;Name, Name&gt;&gt;&amp; trace_names) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> PairSet&gt;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a0a076f5dddae84960769976d67e136b8">trace</a>(PairSet&amp;&amp; trace_names)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a0a076f5dddae84960769976d67e136b8">trace</a>({trace_names.begin(), trace_names.end()});</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keyword">using</span> <a class="code" href="structTAT_1_1Tensor.html#a8ae719096b85159cda723101729ee703">SingularType</a> =</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="preprocessor">#ifdef TAT_USE_SINGULAR_MATRIX</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            Tensor&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            Singular&lt;ScalarType, Symmetry, Name&gt;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a8ae719096b85159cda723101729ee703">  672</a></span>&#160;            ;</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html">  677</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structTAT_1_1Tensor_1_1svd__result.html">svd_result</a> {</div>
<div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html#af065d89636ad3faf3dfdf1a50fd21027">  678</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html#af065d89636ad3faf3dfdf1a50fd21027">U</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html#a8b3bc9309ca0b57b20fce17a33b189e4">  679</a></span>&#160;         <a class="code" href="structTAT_1_1Singular.html">SingularType</a> <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html#a8b3bc9309ca0b57b20fce17a33b189e4">S</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1svd__result.html#a4645d1561dd1e20f86c04b78a59ab71f">  680</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html#a4645d1561dd1e20f86c04b78a59ab71f">V</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      };</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1qr__result.html">  686</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="structTAT_1_1Tensor_1_1qr__result.html">qr_result</a> {</div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1qr__result.html#aa9f51c7bc41beea03c94dc62fd1f085c">  687</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1qr__result.html#aa9f51c7bc41beea03c94dc62fd1f085c">Q</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor_1_1qr__result.html#a821277cf48976ebc7d7204a725cb4056">  688</a></span>&#160;         <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor_1_1qr__result.html#a821277cf48976ebc7d7204a725cb4056">R</a>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      };</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#aa827a3d73c6b1517abf7e5c1f472561f">multiple</a>(<span class="keyword">const</span> <a class="code" href="structTAT_1_1Singular.html">SingularType</a>&amp; S, <span class="keyword">const</span> Name&amp; name, <span class="keywordtype">char</span> direction, <span class="keywordtype">bool</span> division = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      [[nodiscard]] <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html">svd_result</a></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a9d89e92d6d758c7bfac52e84f3265f20">svd</a>(<span class="keyword">const</span> std::set&lt;Name&gt;&amp; free_name_set_u, <span class="keyword">const</span> Name&amp; common_name_u, <span class="keyword">const</span> Name&amp; common_name_v, <a class="code" href="group__Miscellaneous.html#gac705eedd6237ac6373746e8d473fef14">Size</a> cut = <a class="code" href="group__Miscellaneous.html#gac705eedd6237ac6373746e8d473fef14">Size</a>(-1)) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> FreeNameSet&gt;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] <a class="code" href="structTAT_1_1Tensor_1_1svd__result.html">svd_result</a></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a9d89e92d6d758c7bfac52e84f3265f20">svd</a>(FreeNameSet&amp;&amp; free_name_set_u, <span class="keyword">const</span> Name&amp; common_name_u, <span class="keyword">const</span> Name&amp; common_name_v, <a class="code" href="group__Miscellaneous.html#gac705eedd6237ac6373746e8d473fef14">Size</a> cut = -1)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a9d89e92d6d758c7bfac52e84f3265f20">svd</a>({free_name_set_u.begin(), free_name_set_u.end()}, common_name_u, common_name_v, cut);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      [[nodiscard]] qr_result</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a342a8acb21bfa6dcd6c45a4b4efc3145">qr</a>(<span class="keywordtype">char</span> free_name_direction, <span class="keyword">const</span> std::set&lt;Name&gt;&amp; free_name_set, <span class="keyword">const</span> Name&amp; common_name_q, <span class="keyword">const</span> Name&amp; common_name_r) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#ifdef TAT_USE_EASY_CONVERSION</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> FreeNameSet&gt;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      [[deprecated(<span class="stringliteral">&quot;Easy conversion supported will be dropped&quot;</span>)]] [[nodiscard]] qr_result</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html#a342a8acb21bfa6dcd6c45a4b4efc3145">qr</a>(<span class="keywordtype">char</span> free_name_direction, FreeNameSet&amp;&amp; free_name_set, <span class="keyword">const</span> Name&amp; common_name_q, <span class="keyword">const</span> Name&amp; common_name_r)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#a342a8acb21bfa6dcd6c45a4b4efc3145">qr</a>(free_name_direction, {free_name_set.begin(), free_name_set.end()}, common_name_q, common_name_r);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="preprocessor">#ifdef TAT_USE_MPI</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structTAT_1_1Tensor.html#ab409a6f2d8f3ea1812b65a240ba5280c">send</a>(<span class="keywordtype">int</span> destination) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keyword">static</span> Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ad208b0c8577ff1d5fed6a2b2c945698e">receive</a>(<span class="keywordtype">int</span> source);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ae4cdde69a41a39bdd528983f775ce9a1">send_receive</a>(<span class="keywordtype">int</span> source, <span class="keywordtype">int</span> destination) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#a6cd35ca572f1bec93ba43b4a9de5e69d">broadcast</a>(<span class="keywordtype">int</span> root) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Func&gt;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      Tensor&lt;ScalarType, Symmetry, Name&gt; <a class="code" href="structTAT_1_1Tensor.html#ab2117eb5c897ed1ac6a42807966e372d">reduce</a>(<span class="keywordtype">int</span> root, Func&amp;&amp; <span class="keyword">function</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="structTAT_1_1Tensor.html#a9b5d2765c5e944925af511d75c5a7690">barrier</a>();</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">       * 对各个进程但张量通过求和进行reduce</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#a913bb31e5ca738fb74f646e5512a4c36">  771</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a> <a class="code" href="structTAT_1_1Tensor.html#a913bb31e5ca738fb74f646e5512a4c36">summary</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> root)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="structTAT_1_1Tensor.html#ab2117eb5c897ed1ac6a42807966e372d">reduce</a>(root, [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tensor_1, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; tensor_2) { <span class="keywordflow">return</span> tensor_1 + tensor_2; });</div>
<div class="line"><a name="l00773"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#ac3fced48d823eb9527c54a34afaa2e03">  773</a></span>&#160;      };</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keyword">static</span> <a class="code" href="structTAT_1_1mpi__t.html">mpi_t</a> <a class="code" href="structTAT_1_1Tensor.html#ac3fced48d823eb9527c54a34afaa2e03">mpi</a>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga49ae6a33f427b718575a001beaa4c3b8">meta_put</a>(std::ostream&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keyword">const</span> <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga8e5484f651844dffccddb98f69248f69">data_put</a>(std::ostream&amp;) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga064bded492880e88045141844fe30ec1">meta_get</a>(std::istream&amp;);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="group__IO.html#ga324fca0e2b2ab0e6e4524bda982788fd">data_get</a>(std::istream&amp;);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#ga5f350c294d755e5988a4d1d815770bca">show</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      [[nodiscard]] std::string <a class="code" href="group__IO.html#ga59ec761051073a9191f308e42042a515">dump</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp; <a class="code" href="structTAT_1_1Tensor.html#a202ef1071a4e51b6344395ffbad6f1b8">load</a>(<span class="keyword">const</span> std::string&amp;) &amp;;</div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="line" href="structTAT_1_1Tensor.html#adccf842a212e8fb6b64cdf6585d2619e">  789</a></span>&#160;      <a class="code" href="structTAT_1_1Tensor.html">Tensor&lt;ScalarType, Symmetry, Name&gt;</a>&amp;&amp; <a class="code" href="structTAT_1_1Tensor.html#adccf842a212e8fb6b64cdf6585d2619e">load</a>(<span class="keyword">const</span> std::string&amp; <span class="keywordtype">string</span>) &amp;&amp; {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;         <span class="keywordflow">return</span> std::move(<a class="code" href="structTAT_1_1Tensor.html#a202ef1071a4e51b6344395ffbad6f1b8">load</a>(<span class="keywordtype">string</span>));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      };</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   };</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> ScalarType1, <span class="keyword">typename</span> ScalarType2, <span class="keyword">typename</span> Symmetry, <span class="keyword">typename</span> Name&gt;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   [[nodiscard]] <span class="keyword">auto</span> contract(</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;         <span class="keyword">const</span> Tensor&lt;ScalarType1, Symmetry, Name&gt;&amp; tensor_1,</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;         <span class="keyword">const</span> Tensor&lt;ScalarType2, Symmetry, Name&gt;&amp; tensor_2,</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;         std::set&lt;std::tuple&lt;Name, Name&gt;&gt; contract_names) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="keywordflow">return</span> tensor_1.contract(tensor_2, std::move(contract_names));</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="comment">// TODO: middle 用edge operator表示一个待计算的张量, 在contract中用到</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <span class="comment">// 因为contract的操作是这样的</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <span class="comment">// merge gemm split</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="comment">// 上一次split可以和下一次的merge合并</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   <span class="comment">// 比较重要， 可以大幅减少对称性张量的分块</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <span class="comment">/*</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">   template&lt;typename ScalarType, typename Symmetry, typename Name&gt;</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">   struct QuasiTensor {</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">      Tensor&lt;ScalarType, Symmetry, Name&gt; tensor;</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">      std::map&lt;Name, std::vector&lt;std::tuple&lt;Name, BoseEdge&lt;Symmetry&gt;&gt;&gt;&gt; split_map;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">      std::set&lt;Name&gt; reversed_set;</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">      std::vector&lt;Name&gt; res_name;</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">      QuasiTensor</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">      operator Tensor&lt;ScalarType, Symmetry, Name&gt;() &amp;&amp; {</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">         return tensor.edge_operator({}, split_map, reversed_set, {}, std::move(res_name));</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">      operator Tensor&lt;ScalarType, Symmetry, Name&gt;() const&amp; {</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">         return tensor.edge_operator({}, split_map, reversed_set, {}, res_name);</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">      Tensor&lt;ScalarType, Symmetry, Name&gt; merge_again(</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">            const std::set&lt;Name&gt;&amp; merge_reversed_set,</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">            const std::map&lt;Name, std::vector&lt;Name&gt;&gt;&amp; merge_map,</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">            std::vector&lt;Name&gt;&amp;&amp; merge_res_name,</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">            std::set&lt;Name&gt;&amp; split_parity_mark,</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">            std::set&lt;Name&gt;&amp; merge_parity_mark) {</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">         auto total_reversed_set = reversed_set; // merge_reversed_set</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">         return tensor.edge_operator(</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">               {},</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">               split_map,</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">               total_reversed_set,</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">               merge_map,</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">               merge_res_name,</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">               false,</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">               {{{}, split_parity_mark, {}, merge_parity_mark}});</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">      QuasiTensor&lt;ScalarType, Symmetry, Name&gt;</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">   };</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <span class="comment">// TODO: lazy framework</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   <span class="comment">// 看一下idris是如何做的</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   <span class="comment">// 需要考虑深搜不可行的问题</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <span class="comment">// 支持inplace操作</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;} <span class="comment">// namespace TAT</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__Miscellaneous_html_gac705eedd6237ac6373746e8d473fef14"><div class="ttname"><a href="group__Miscellaneous.html#gac705eedd6237ac6373746e8d473fef14">TAT::Size</a></div><div class="ttdeci">unsigned long Size</div><div class="ttdoc">张量数据维度大小和数据本身大小的类型</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:44</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a249f71a6068ebf0932c6566e18c3e11b"><div class="ttname"><a href="structTAT_1_1Tensor.html#a249f71a6068ebf0932c6566e18c3e11b">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor(std::vector&lt; Name &gt; names_init, std::vector&lt; Edge&lt; Symmetry &gt;&gt; edges_init, const bool auto_reverse=false)</div><div class="ttdoc">根据张量边的名称和形状构造张量, 分块将自动根据对称性进行处理</div><div class="ttdef"><b>Definition:</b> tensor.hpp:144</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_acad907b1894ad6b0e54b92e3c2f28574"><div class="ttname"><a href="structTAT_1_1Tensor.html#acad907b1894ad6b0e54b92e3c2f28574">TAT::Tensor::expand</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; expand(const std::map&lt; Name, EdgeInfoWithArrowForExpand &gt; &amp;configure, const Name &amp;old_name=InternalName&lt; Name &gt;::No_Old_Name) const</div><div class="ttdef"><b>Definition:</b> shrink_and_expand.hpp:29</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html_a4645d1561dd1e20f86c04b78a59ab71f"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html#a4645d1561dd1e20f86c04b78a59ab71f">TAT::Tensor::svd_result::V</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; V</div><div class="ttdef"><b>Definition:</b> tensor.hpp:680</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a439e664b9580d6514c65f7f866f288d2"><div class="ttname"><a href="structTAT_1_1Tensor.html#a439e664b9580d6514c65f7f866f288d2">TAT::Tensor::transpose</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; transpose(std::vector&lt; Name &gt; target_names) const</div><div class="ttdoc">对张量进行转置</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:45</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a04b37643797ad7da56f258c2996a4135"><div class="ttname"><a href="structTAT_1_1Tensor.html#a04b37643797ad7da56f258c2996a4135">TAT::Tensor::symmetry_valid</a></div><div class="ttdeci">std::enable_if_t&lt; is_symmetry_v&lt; Symmetry &gt; &gt; symmetry_valid</div><div class="ttdef"><b>Definition:</b> tensor.hpp:116</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a6cb81dfbd5808d32766b0acf5a60a9aa"><div class="ttname"><a href="structTAT_1_1Tensor.html#a6cb81dfbd5808d32766b0acf5a60a9aa">TAT::Tensor::norm</a></div><div class="ttdeci">real_base_t&lt; ScalarType &gt; norm() const</div><div class="ttdoc">求张量的模, 是拉平看作向量的模, 并不是矩阵模之类的东西</div><div class="ttdef"><b>Definition:</b> tensor.hpp:430</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_abbe401ff6d00b18a4e110e4e6b8aa3aa"><div class="ttname"><a href="structTAT_1_1Tensor.html#abbe401ff6d00b18a4e110e4e6b8aa3aa">TAT::Tensor::reverse_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; reverse_edge(const std::set&lt; Name &gt; &amp;reversed_name, bool apply_parity=false, const std::set&lt; Name &gt; &amp;parity_exclude_name={}) const</div><div class="ttdoc">将费米张量的一些边进行反转</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:50</div></div>
<div class="ttc" id="astructTAT_1_1Core_html"><div class="ttname"><a href="structTAT_1_1Core.html">TAT::Core</a></div><div class="ttdoc">记录了张量的核心数据的类型, 核心数据指的是除了角标名称之外的信息, 包括边的形状, 以及张量内本身的数据</div><div class="ttdef"><b>Definition:</b> core.hpp:110</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1qr__result_html"><div class="ttname"><a href="structTAT_1_1Tensor_1_1qr__result.html">TAT::Tensor::qr_result</a></div><div class="ttdoc">张量qr的结果类型</div><div class="ttdef"><b>Definition:</b> tensor.hpp:686</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab409a6f2d8f3ea1812b65a240ba5280c"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab409a6f2d8f3ea1812b65a240ba5280c">TAT::Tensor::send</a></div><div class="ttdeci">void send(int destination) const</div><div class="ttdoc">source调用此函数, 向destination发送一个张量</div><div class="ttdef"><b>Definition:</b> mpi.hpp:126</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a202ef1071a4e51b6344395ffbad6f1b8"><div class="ttname"><a href="structTAT_1_1Tensor.html#a202ef1071a4e51b6344395ffbad6f1b8">TAT::Tensor::load</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; load(const std::string &amp;) &amp;</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a529084aace9257dd27b0b61bde589888"><div class="ttname"><a href="structTAT_1_1Tensor.html#a529084aace9257dd27b0b61bde589888">TAT::Tensor::name_valid</a></div><div class="ttdeci">std::enable_if_t&lt; is_name_v&lt; Name &gt; &gt; name_valid</div><div class="ttdef"><b>Definition:</b> tensor.hpp:117</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a631e4cbdf89566dcb8dd525f9648bc65"><div class="ttname"><a href="structTAT_1_1Singular.html#a631e4cbdf89566dcb8dd525f9648bc65">TAT::Singular::value</a></div><div class="ttdeci">singular_map value</div><div class="ttdef"><b>Definition:</b> tensor.hpp:59</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac3fced48d823eb9527c54a34afaa2e03"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac3fced48d823eb9527c54a34afaa2e03">TAT::Tensor::mpi</a></div><div class="ttdeci">static mpi_t mpi</div><div class="ttdef"><b>Definition:</b> tensor.hpp:773</div></div>
<div class="ttc" id="astructTAT_1_1BoseEdge_html"><div class="ttname"><a href="structTAT_1_1BoseEdge.html">TAT::BoseEdge</a></div><div class="ttdef"><b>Definition:</b> edge.hpp:113</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a6cd35ca572f1bec93ba43b4a9de5e69d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a6cd35ca572f1bec93ba43b4a9de5e69d">TAT::Tensor::broadcast</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; broadcast(int root) const</div><div class="ttdoc">从root进程分发张量, 使用简单的树形分发, 必须所有进程一起调用这个函数</div><div class="ttdef"><b>Definition:</b> mpi.hpp:156</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1qr__result_html_a821277cf48976ebc7d7204a725cb4056"><div class="ttname"><a href="structTAT_1_1Tensor_1_1qr__result.html#a821277cf48976ebc7d7204a725cb4056">TAT::Tensor::qr_result::R</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; R</div><div class="ttdef"><b>Definition:</b> tensor.hpp:688</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab1e8b48602667685790b72681050af1c"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab1e8b48602667685790b72681050af1c">TAT::Tensor::conjugate</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; conjugate() const</div><div class="ttdoc">生成张量的共轭张量</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:110</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9d94cc5a258afdf3b256779df8a8bd9b"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9d94cc5a258afdf3b256779df8a8bd9b">TAT::Tensor::copy</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; copy() const</div><div class="ttdoc">张量的复制, 默认的赋值和复制初始化不会拷贝数据，而会共用core</div><div class="ttdef"><b>Definition:</b> tensor.hpp:169</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9b5d2765c5e944925af511d75c5a7690"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9b5d2765c5e944925af511d75c5a7690">TAT::Tensor::barrier</a></div><div class="ttdeci">static void barrier()</div><div class="ttdoc">mpi进程间同步</div><div class="ttdef"><b>Definition:</b> mpi.hpp:228</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae4cdde69a41a39bdd528983f775ce9a1"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae4cdde69a41a39bdd528983f775ce9a1">TAT::Tensor::send_receive</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; send_receive(int source, int destination) const</div><div class="ttdoc">像简单类型一样使用mpi但send和receive, 调用后, 一个destination返回source调用时输入tensor, 其他进程返回空张量</div><div class="ttdef"><b>Definition:</b> mpi.hpp:145</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a24856542d03837f09da3a2f2efd78c67"><div class="ttname"><a href="structTAT_1_1Tensor.html#a24856542d03837f09da3a2f2efd78c67">TAT::Tensor::one</a></div><div class="ttdeci">static Tensor&lt; ScalarType, Symmetry, Name &gt; one(ScalarType number, std::vector&lt; Name &gt; names_init, const std::vector&lt; Symmetry &gt; &amp;edge_symmetry={}, const std::vector&lt; Arrow &gt; &amp;edge_arrow={})</div><div class="ttdoc">创建高秩但是元素只有一个的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:208</div></div>
<div class="ttc" id="astructTAT_1_1fake__map_html"><div class="ttname"><a href="structTAT_1_1fake__map.html">TAT::fake_map</a></div><div class="ttdoc">只有一个元素的假map</div><div class="ttdef"><b>Definition:</b> edge.hpp:41</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html"><div class="ttname"><a href="structTAT_1_1Singular.html">TAT::Singular</a></div><div class="ttdoc">张量看成矩阵后做svd分解后得到的奇异值类型, 为对角矩阵形式的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:51</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a5065992828c0a3cb6b8358ea0adbd4fc"><div class="ttname"><a href="structTAT_1_1Tensor.html#a5065992828c0a3cb6b8358ea0adbd4fc">TAT::Tensor::identity</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; identity(const std::set&lt; std::tuple&lt; Name, Name &gt;&gt; &amp;pairs) const</div><div class="ttdoc">生成相同形状的单位张量</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:194</div></div>
<div class="ttc" id="aname_8hpp_html"><div class="ttname"><a href="name_8hpp.html">name.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad8f4ac89efc12b4afdfbe6fb12cb781b"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad8f4ac89efc12b4afdfbe6fb12cb781b">TAT::Tensor::edge_rename</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; edge_rename(const std::map&lt; Name, Name &gt; &amp;dictionary) const</div><div class="ttdoc">对张量边的名称进行重命名</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:28</div></div>
<div class="ttc" id="astructTAT_1_1mpi__t_html"><div class="ttname"><a href="structTAT_1_1mpi__t.html">TAT::mpi_t</a></div><div class="ttdoc">一个mpi handler, 会在构造和析构时自动调用MPI_Init和MPI_Finalize, 且会获取Size和Rank信息</div><div class="ttdef"><b>Definition:</b> mpi.hpp:77</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a1acbadd2866fc14ef81b549cd25b2686"><div class="ttname"><a href="structTAT_1_1Singular.html#a1acbadd2866fc14ef81b549cd25b2686">TAT::Singular::load</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; &amp; load(const std::string &amp;) &amp;</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga78326bee7cc963cd2d165718de5c0465"><div class="ttname"><a href="group__Miscellaneous.html#ga78326bee7cc963cd2d165718de5c0465">TAT::Arrow</a></div><div class="ttdeci">bool Arrow</div><div class="ttdoc">费米箭头方向的类型, false和true分别表示出入</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:62</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aa6b84a6f099ca0193a0ad6e9e8e04415"><div class="ttname"><a href="structTAT_1_1Tensor.html#aa6b84a6f099ca0193a0ad6e9e8e04415">TAT::Tensor::map</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; map(Transform &amp;&amp;function) const</div><div class="ttdoc">对张量的每个数据元素做同样的非原地的变换</div><div class="ttdef"><b>Definition:</b> tensor.hpp:264</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ada0abaf67e239dc3e74a83aafdf31c3b"><div class="ttname"><a href="structTAT_1_1Tensor.html#ada0abaf67e239dc3e74a83aafdf31c3b">TAT::Tensor::contract</a></div><div class="ttdeci">static Tensor&lt; ScalarType, Symmetry, Name &gt; contract(const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;tensor_1, const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;tensor_2, std::set&lt; std::tuple&lt; Name, Name &gt;&gt; contract_names)</div><div class="ttdoc">两个张量的缩并运算</div><div class="ttdef"><b>Definition:</b> contract.hpp:275</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a24d53d8dd85af8c4a0ee21fbc8dd6b41"><div class="ttname"><a href="structTAT_1_1Tensor.html#a24d53d8dd85af8c4a0ee21fbc8dd6b41">TAT::Tensor::const_block</a></div><div class="ttdeci">const auto &amp; const_block(const std::map&lt; Name, Symmetry &gt; &amp;position={}) const &amp;</div><div class="ttdef"><b>Definition:</b> get_item.hpp:99</div></div>
<div class="ttc" id="agroup__IO_html_ga49ae6a33f427b718575a001beaa4c3b8"><div class="ttname"><a href="group__IO.html#ga49ae6a33f427b718575a001beaa4c3b8">TAT::Tensor::meta_put</a></div><div class="ttdeci">const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; meta_put(std::ostream &amp;) const</div><div class="ttdef"><b>Definition:</b> io.hpp:556</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab102bd3898b58fff24b10ed07f3221e6"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab102bd3898b58fff24b10ed07f3221e6">TAT::Tensor::to</a></div><div class="ttdeci">Tensor&lt; OtherScalarType, Symmetry, Name &gt; to() const</div><div class="ttdoc">不同标量类型的张量之间的转换函数</div><div class="ttdef"><b>Definition:</b> tensor.hpp:396</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a5af47d0d4040ad64017c416f449a67cf"><div class="ttname"><a href="structTAT_1_1Tensor.html#a5af47d0d4040ad64017c416f449a67cf">TAT::Tensor::at</a></div><div class="ttdeci">const ScalarType &amp; at(const std::map&lt; Name, EdgeInfoForGetItem &gt; &amp;position) const &amp;</div><div class="ttdoc">获取张量中某个分块内的某个元素</div><div class="ttdef"><b>Definition:</b> tensor.hpp:370</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aa827a3d73c6b1517abf7e5c1f472561f"><div class="ttname"><a href="structTAT_1_1Tensor.html#aa827a3d73c6b1517abf7e5c1f472561f">TAT::Tensor::multiple</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; multiple(const SingularType &amp;S, const Name &amp;name, char direction, bool division=false) const</div><div class="ttdoc">张量缩并上SVD产生的奇异值数据, 就地操作</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:30</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a99633cbb2776da691ad804a23f8e7d99"><div class="ttname"><a href="structTAT_1_1Tensor.html#a99633cbb2776da691ad804a23f8e7d99">TAT::Tensor::contract_all_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; contract_all_edge(const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;other) const</div><div class="ttdoc">将一个张量与另一个张量的所有相同名称的边进行缩并</div><div class="ttdef"><b>Definition:</b> tensor.hpp:605</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_gac50ae59af1a35e2ecec08941c3d1115d"><div class="ttname"><a href="group__Miscellaneous.html#gac50ae59af1a35e2ecec08941c3d1115d">TAT::Nums</a></div><div class="ttdeci">unsigned int Nums</div><div class="ttdoc">张量分块数目和一个边上对称性数目的类型</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:40</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga40f46f83982bd27a7e204d8a1360b6a0"><div class="ttname"><a href="group__Miscellaneous.html#ga40f46f83982bd27a7e204d8a1360b6a0">TAT::TAT_error</a></div><div class="ttdeci">void TAT_error(const char *message)</div><div class="ttdoc">TAT使用的抛出运行时异常</div><div class="ttdef"><b>Definition:</b> mpi.hpp:282</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html">TAT::Tensor::svd_result</a></div><div class="ttdoc">张量svd的结果类型</div><div class="ttdef"><b>Definition:</b> tensor.hpp:677</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a0fe4f7437b71de7367ca2623a2111aaa"><div class="ttname"><a href="structTAT_1_1Tensor.html#a0fe4f7437b71de7367ca2623a2111aaa">TAT::Tensor::test</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; test(ScalarType first=0, ScalarType step=1) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:335</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a626e84e32ab8019597c60ada6f9a45ea"><div class="ttname"><a href="structTAT_1_1Tensor.html#a626e84e32ab8019597c60ada6f9a45ea">TAT::Tensor::shrink</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; shrink(const std::map&lt; Name, EdgeInfoForGetItem &gt; &amp;configure, const Name &amp;new_name=InternalName&lt; Name &gt;::No_New_Name, Arrow arrow=false) const</div><div class="ttdef"><b>Definition:</b> shrink_and_expand.hpp:97</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9d89e92d6d758c7bfac52e84f3265f20"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9d89e92d6d758c7bfac52e84f3265f20">TAT::Tensor::svd</a></div><div class="ttdeci">svd_result svd(const std::set&lt; Name &gt; &amp;free_name_set_u, const Name &amp;common_name_u, const Name &amp;common_name_v, Size cut=Size(-1)) const</div><div class="ttdoc">对张量进行svd分解</div><div class="ttdef"><b>Definition:</b> svd.hpp:251</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_afe3ee11efb23ff4d93e6a565d607cbfe"><div class="ttname"><a href="structTAT_1_1Tensor.html#afe3ee11efb23ff4d93e6a565d607cbfe">TAT::Tensor::contract</a></div><div class="ttdeci">static auto contract(const Tensor&lt; ScalarType1, Symmetry, Name &gt; &amp;tensor_1, const Tensor&lt; ScalarType2, Symmetry, Name &gt; &amp;tensor_2, std::set&lt; std::tuple&lt; Name, Name &gt;&gt; contract_names)</div><div class="ttdef"><b>Definition:</b> tensor.hpp:559</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a25052984c028c2913d77fc0ed079f02d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a25052984c028c2913d77fc0ed079f02d">TAT::Tensor::zero</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; zero() &amp;</div><div class="ttdoc">将张量内的数据全部设置为零</div><div class="ttdef"><b>Definition:</b> tensor.hpp:316</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html_a8b3bc9309ca0b57b20fce17a33b189e4"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html#a8b3bc9309ca0b57b20fce17a33b189e4">TAT::Tensor::svd_result::S</a></div><div class="ttdeci">SingularType S</div><div class="ttdef"><b>Definition:</b> tensor.hpp:679</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ace1791bdc2285cf186be58d30d7c9f42"><div class="ttname"><a href="structTAT_1_1Tensor.html#ace1791bdc2285cf186be58d30d7c9f42">TAT::Tensor::slice</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; slice(const std::map&lt; Name, EdgeInfoForGetItem &gt; &amp;configure, const Name &amp;new_name=InternalName&lt; Name &gt;::No_New_Name, Arrow arrow=false) const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:245</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a070c446e688bad4dd586b4e5f23ebb6c"><div class="ttname"><a href="structTAT_1_1Tensor.html#a070c446e688bad4dd586b4e5f23ebb6c">TAT::Tensor::test</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; test(ScalarType first=0, ScalarType step=1) &amp;</div><div class="ttdoc">将张量内的数据设置为便于测试的值</div><div class="ttdef"><b>Definition:</b> tensor.hpp:328</div></div>
<div class="ttc" id="aedge_8hpp_html"><div class="ttname"><a href="edge_8hpp.html">edge.hpp</a></div></div>
<div class="ttc" id="abasic__type_8hpp_html"><div class="ttname"><a href="basic__type_8hpp.html">basic_type.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a8ae719096b85159cda723101729ee703"><div class="ttname"><a href="structTAT_1_1Tensor.html#a8ae719096b85159cda723101729ee703">TAT::Tensor::SingularType</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; SingularType</div><div class="ttdef"><b>Definition:</b> tensor.hpp:672</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a246a14a49fc37102d2b184d4cc08c11b"><div class="ttname"><a href="structTAT_1_1Tensor.html#a246a14a49fc37102d2b184d4cc08c11b">TAT::Tensor::contract</a></div><div class="ttdeci">auto contract(const Tensor&lt; OtherScalarType, Symmetry, Name &gt; &amp;tensor_2, std::set&lt; std::tuple&lt; Name, Name &gt;&gt; contract_names) const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:582</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a7a99ba8f4a7a6a7e1185b6fac04cbb58"><div class="ttname"><a href="structTAT_1_1Tensor.html#a7a99ba8f4a7a6a7e1185b6fac04cbb58">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor(std::vector&lt; Name &gt; names_init, const std::vector&lt; Int &gt; &amp;edges_init)</div><div class="ttdef"><b>Definition:</b> tensor.hpp:152</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab2117eb5c897ed1ac6a42807966e372d"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab2117eb5c897ed1ac6a42807966e372d">TAT::Tensor::reduce</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; reduce(int root, Func &amp;&amp;function) const</div><div class="ttdoc">向root进程reduce张量, 使用简单的树形reduce, 必须所有进程一起调用这个函数, 最后root进程返回全部reduce的结果, 其他进程为中间结果一般无意义</div><div class="ttdef"><b>Definition:</b> mpi.hpp:191</div></div>
<div class="ttc" id="astructTAT_1_1InternalName_html"><div class="ttname"><a href="structTAT_1_1InternalName.html">TAT::InternalName</a></div><div class="ttdoc">对于每个将要被使用做Name的类型, 需要设置一部分保留类型</div><div class="ttdef"><b>Definition:</b> name.hpp:138</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad4dca3481df8511db539e12297b8dc90"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad4dca3481df8511db539e12297b8dc90">TAT::Tensor::name_to_index</a></div><div class="ttdeci">std::map&lt; Name, Rank &gt; name_to_index</div><div class="ttdoc">张量边名称到边的序号的映射表</div><div class="ttdef"><b>Definition:</b> tensor.hpp:129</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9cf93a852d354ee03e3ae33e278ec396"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9cf93a852d354ee03e3ae33e278ec396">TAT::Tensor::transform</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; transform(Transform &amp;&amp;function) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:291</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a342a8acb21bfa6dcd6c45a4b4efc3145"><div class="ttname"><a href="structTAT_1_1Tensor.html#a342a8acb21bfa6dcd6c45a4b4efc3145">TAT::Tensor::qr</a></div><div class="ttdeci">qr_result qr(char free_name_direction, const std::set&lt; Name &gt; &amp;free_name_set, const Name &amp;common_name_q, const Name &amp;common_name_r) const</div><div class="ttdoc">对张量进行qr分解</div><div class="ttdef"><b>Definition:</b> qr.hpp:314</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a251207a171aed3995dda904fec5528f6"><div class="ttname"><a href="structTAT_1_1Singular.html#a251207a171aed3995dda904fec5528f6">TAT::Singular::fake_singular_map</a></div><div class="ttdeci">fake_map&lt; Symmetry, vector&lt; real_base_t&lt; ScalarType &gt; &gt;&gt; fake_singular_map</div><div class="ttdef"><b>Definition:</b> tensor.hpp:53</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac9d58b022a6f1eaa0dfb74dcb145eb31"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac9d58b022a6f1eaa0dfb74dcb145eb31">TAT::Tensor::contract_all_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; contract_all_edge() const</div><div class="ttdoc">张量与自己的共轭进行尽可能的缩并</div><div class="ttdef"><b>Definition:</b> tensor.hpp:618</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a1eb633a8b129a8c1f2b2b0caf5659815"><div class="ttname"><a href="structTAT_1_1Tensor.html#a1eb633a8b129a8c1f2b2b0caf5659815">TAT::Tensor::MapIteratorList</a></div><div class="ttdeci">std::vector&lt; typename Edge&lt; Symmetry &gt;::edge_map::const_iterator &gt; MapIteratorList</div><div class="ttdef"><b>Definition:</b> tensor.hpp:465</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac7fa382fd250903d72418b8e10ed4a65"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac7fa382fd250903d72418b8e10ed4a65">TAT::Tensor::set</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; set(Generator &amp;&amp;generator) &amp;</div><div class="ttdoc">通过一个生成器设置一个张量内的数据</div><div class="ttdef"><b>Definition:</b> tensor.hpp:302</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_afaf08baeb2eed70e2f64e7af12dfeb8a"><div class="ttname"><a href="structTAT_1_1Tensor.html#afaf08baeb2eed70e2f64e7af12dfeb8a">TAT::Tensor::EdgeInfoForGetItem</a></div><div class="ttdeci">std::conditional_t&lt; std::is_same_v&lt; Symmetry, NoSymmetry &gt;, Size, std::tuple&lt; Symmetry, Size &gt; &gt; EdgeInfoForGetItem</div><div class="ttdef"><b>Definition:</b> tensor.hpp:232</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1svd__result_html_af065d89636ad3faf3dfdf1a50fd21027"><div class="ttname"><a href="structTAT_1_1Tensor_1_1svd__result.html#af065d89636ad3faf3dfdf1a50fd21027">TAT::Tensor::svd_result::U</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; U</div><div class="ttdef"><b>Definition:</b> tensor.hpp:678</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab8d8eca0c4f84479cce88768038592d9"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab8d8eca0c4f84479cce88768038592d9">TAT::Tensor::block</a></div><div class="ttdeci">const auto &amp; block(const std::map&lt; Name, Symmetry &gt; &amp;position={}) const &amp;</div><div class="ttdoc">获取张量的某个分块</div><div class="ttdef"><b>Definition:</b> tensor.hpp:345</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a17de08d8837e04b110ae0d6ea2a90676"><div class="ttname"><a href="structTAT_1_1Singular.html#a17de08d8837e04b110ae0d6ea2a90676">TAT::Singular::norm</a></div><div class="ttdeci">real_base_t&lt; ScalarType &gt; norm() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:62</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2a45b860499d4eaa7829efd3bcbdb1e9"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2a45b860499d4eaa7829efd3bcbdb1e9">TAT::Tensor::is_scalar</a></div><div class="ttdeci">bool is_scalar() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:218</div></div>
<div class="ttc" id="astructTAT_1_1Edge_html"><div class="ttname"><a href="structTAT_1_1Edge.html">TAT::Edge&lt; Symmetry &gt;</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aadd1a1522ea372390783d72cc23fedf2"><div class="ttname"><a href="structTAT_1_1Tensor.html#aadd1a1522ea372390783d72cc23fedf2">TAT::Tensor::core</a></div><div class="ttdeci">std::shared_ptr&lt; Core&lt; ScalarType, Symmetry &gt; &gt; core</div><div class="ttdoc">张量中出了边名称外的其他数据</div><div class="ttdef"><b>Definition:</b> tensor.hpp:135</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_aff3fe646de6b8d94251e0d8096cad12b"><div class="ttname"><a href="structTAT_1_1Tensor.html#aff3fe646de6b8d94251e0d8096cad12b">TAT::Tensor::names</a></div><div class="ttdeci">std::vector&lt; Name &gt; names</div><div class="ttdoc">张量的边的名称</div><div class="ttdef"><b>Definition:</b> tensor.hpp:124</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a67773ad17527d10e1129478340cda72e"><div class="ttname"><a href="structTAT_1_1Tensor.html#a67773ad17527d10e1129478340cda72e">TAT::Tensor::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:177</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a2709db65768862bc9c5d05fa6686cb9a"><div class="ttname"><a href="structTAT_1_1Singular.html#a2709db65768862bc9c5d05fa6686cb9a">TAT::Singular::normal_map</a></div><div class="ttdeci">std::map&lt; Symmetry, vector&lt; real_base_t&lt; ScalarType &gt; &gt;&gt; normal_map</div><div class="ttdef"><b>Definition:</b> tensor.hpp:52</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a0a076f5dddae84960769976d67e136b8"><div class="ttname"><a href="structTAT_1_1Tensor.html#a0a076f5dddae84960769976d67e136b8">TAT::Tensor::trace</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; trace(const std::set&lt; std::tuple&lt; Name, Name &gt;&gt; &amp;trace_names) const</div><div class="ttdef"><b>Definition:</b> trace.hpp:29</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae63a2323a01a71dda38b8856cb5a532b"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae63a2323a01a71dda38b8856cb5a532b">TAT::Tensor::zero</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; zero() &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:319</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ae7c9939fc28077a7aaabc7da37aeab66"><div class="ttname"><a href="structTAT_1_1Tensor.html#ae7c9939fc28077a7aaabc7da37aeab66">TAT::Tensor::merge_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; merge_edge(std::map&lt; Name, std::vector&lt; Name &gt;&gt; merge, bool apply_parity=false, const std::set&lt; Name &gt; &amp;parity_exclude_name_merge={}, const std::set&lt; Name &gt; &amp;parity_exclude_name_reverse={}) const</div><div class="ttdoc">合并张量的一些边</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:58</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a9cc15c9afe143966029c1d0dc8fa6f91"><div class="ttname"><a href="structTAT_1_1Tensor.html#a9cc15c9afe143966029c1d0dc8fa6f91">TAT::Tensor::scalar_valid</a></div><div class="ttdeci">std::enable_if_t&lt; is_scalar_v&lt; ScalarType &gt; &gt; scalar_valid</div><div class="ttdef"><b>Definition:</b> tensor.hpp:115</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2c908557416bb3b3c72896320aa30106"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2c908557416bb3b3c72896320aa30106">TAT::Tensor::set</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; set(Generator &amp;&amp;generator) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:307</div></div>
<div class="ttc" id="agroup__IO_html_ga064bded492880e88045141844fe30ec1"><div class="ttname"><a href="group__IO.html#ga064bded492880e88045141844fe30ec1">TAT::Tensor::meta_get</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; meta_get(std::istream &amp;)</div><div class="ttdef"><b>Definition:</b> io.hpp:603</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_adccf842a212e8fb6b64cdf6585d2619e"><div class="ttname"><a href="structTAT_1_1Tensor.html#adccf842a212e8fb6b64cdf6585d2619e">TAT::Tensor::load</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; load(const std::string &amp;string) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:789</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a4cebe372f267460b8d0a558e2db7139a"><div class="ttname"><a href="structTAT_1_1Tensor.html#a4cebe372f267460b8d0a558e2db7139a">TAT::Tensor::const_at</a></div><div class="ttdeci">const ScalarType &amp; const_at(const std::map&lt; Name, EdgeInfoForGetItem &gt; &amp;position) const &amp;</div><div class="ttdef"><b>Definition:</b> get_item.hpp:121</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_af2f426b740f06990a2decc2213413de5"><div class="ttname"><a href="structTAT_1_1Tensor.html#af2f426b740f06990a2decc2213413de5">TAT::Tensor::exponential</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; exponential(const std::set&lt; std::tuple&lt; Name, Name &gt;&gt; &amp;pairs, int step=2) const</div><div class="ttdoc">看作矩阵后求出矩阵指数</div><div class="ttdef"><b>Definition:</b> tensor_miscellaneous.hpp:252</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_1_1qr__result_html_aa9f51c7bc41beea03c94dc62fd1f085c"><div class="ttname"><a href="structTAT_1_1Tensor_1_1qr__result.html#aa9f51c7bc41beea03c94dc62fd1f085c">TAT::Tensor::qr_result::Q</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; Q</div><div class="ttdef"><b>Definition:</b> tensor.hpp:687</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ac499e258364f1d6fe53b081cf837648b"><div class="ttname"><a href="structTAT_1_1Tensor.html#ac499e258364f1d6fe53b081cf837648b">TAT::Tensor::EdgeInfoWithArrowForExpand</a></div><div class="ttdeci">std::conditional_t&lt; std::is_same_v&lt; Symmetry, NoSymmetry &gt;, std::tuple&lt; Size, Size &gt;, std::conditional_t&lt; is_fermi_symmetry_v&lt; Symmetry &gt;, std::tuple&lt; Arrow, Symmetry, Size, Size &gt;, std::tuple&lt; Symmetry, Size, Size &gt; &gt;&gt; EdgeInfoWithArrowForExpand</div><div class="ttdef"><b>Definition:</b> tensor.hpp:236</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a2e1ca6a58056b952a50e3238ba2a533c"><div class="ttname"><a href="structTAT_1_1Tensor.html#a2e1ca6a58056b952a50e3238ba2a533c">TAT::Tensor::operator=</a></div><div class="ttdeci">Tensor &amp; operator=(const Tensor &amp;other)=default</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html"><div class="ttname"><a href="structTAT_1_1Tensor.html">TAT::Tensor</a></div><div class="ttdoc">张量类型</div><div class="ttdef"><b>Definition:</b> tensor.hpp:114</div></div>
<div class="ttc" id="agroup__IO_html_ga59ec761051073a9191f308e42042a515"><div class="ttname"><a href="group__IO.html#ga59ec761051073a9191f308e42042a515">TAT::Tensor::dump</a></div><div class="ttdeci">std::string dump() const</div><div class="ttdef"><b>Definition:</b> io.hpp:579</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a8419fd382c3d74ceafb7b9b06e0214ca"><div class="ttname"><a href="structTAT_1_1Tensor.html#a8419fd382c3d74ceafb7b9b06e0214ca">TAT::Tensor::same_shape</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; same_shape() const</div><div class="ttdoc">产生一个与自己形状一样的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:253</div></div>
<div class="ttc" id="acore_8hpp_html"><div class="ttname"><a href="core_8hpp.html">core.hpp</a></div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad208b0c8577ff1d5fed6a2b2c945698e"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad208b0c8577ff1d5fed6a2b2c945698e">TAT::Tensor::receive</a></div><div class="ttdeci">static Tensor&lt; ScalarType, Symmetry, Name &gt; receive(int source)</div><div class="ttdoc">destination调用此函数, 从source接受一个张量</div><div class="ttdef"><b>Definition:</b> mpi.hpp:133</div></div>
<div class="ttc" id="asymmetry_8hpp_html"><div class="ttname"><a href="symmetry_8hpp.html">symmetry.hpp</a></div></div>
<div class="ttc" id="agroup__IO_html_ga8e5484f651844dffccddb98f69248f69"><div class="ttname"><a href="group__IO.html#ga8e5484f651844dffccddb98f69248f69">TAT::Tensor::data_put</a></div><div class="ttdeci">const Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; data_put(std::ostream &amp;) const</div><div class="ttdef"><b>Definition:</b> io.hpp:563</div></div>
<div class="ttc" id="anamespaceTAT_html"><div class="ttname"><a href="namespaceTAT.html">TAT</a></div><div class="ttdoc">TAT is A Tensor library</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:27</div></div>
<div class="ttc" id="agroup__IO_html_gaa69be631b50d82c02164fe90977565b0"><div class="ttname"><a href="group__IO.html#gaa69be631b50d82c02164fe90977565b0">TAT::Singular::show</a></div><div class="ttdeci">std::string show() const</div><div class="ttdef"><b>Definition:</b> io.hpp:549</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_aeed42467b017f72ad76cdfea159622d3"><div class="ttname"><a href="structTAT_1_1Singular.html#aeed42467b017f72ad76cdfea159622d3">TAT::Singular::singular_map</a></div><div class="ttdeci">normal_map singular_map</div><div class="ttdef"><b>Definition:</b> tensor.hpp:57</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a4df7b1315f2abd7065ef9f2053ee9a7a"><div class="ttname"><a href="structTAT_1_1Tensor.html#a4df7b1315f2abd7065ef9f2053ee9a7a">TAT::Tensor::edge_operator</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; edge_operator(const std::map&lt; Name, Name &gt; &amp;rename_map, const std::map&lt; Name, std::vector&lt; std::tuple&lt; Name, BoseEdge&lt; Symmetry, split_edge_is_pointer &gt;&gt;&gt;&gt; &amp;split_map, const std::set&lt; Name &gt; &amp;reversed_name, const std::map&lt; Name, std::vector&lt; Name &gt;&gt; &amp;merge_map, std::vector&lt; Name &gt; new_names, bool apply_parity=false, const std::array&lt; std::set&lt; Name &gt;, 4 &gt; &amp;parity_exclude_name={{{}, {}, {}, {}}}, const std::map&lt; Name, std::map&lt; Symmetry, Size &gt;&gt; &amp;edge_and_symmetries_to_cut_before_all={}) const</div><div class="ttdoc">对张量的边进行操作的中枢函数, 对边依次做重命名, 分裂, 费米箭头取反, 合并, 转置的操作,</div><div class="ttdef"><b>Definition:</b> edge_operator.hpp:31</div></div>
<div class="ttc" id="agroup__Miscellaneous_html_ga03fb813e3f2c8c1633ebe103894051a3"><div class="ttname"><a href="group__Miscellaneous.html#ga03fb813e3f2c8c1633ebe103894051a3">TAT::real_base_t</a></div><div class="ttdeci">typename real_base&lt; T &gt;::type real_base_t</div><div class="ttdef"><b>Definition:</b> basic_type.hpp:88</div></div>
<div class="ttc" id="agroup__IO_html_ga5f350c294d755e5988a4d1d815770bca"><div class="ttname"><a href="group__IO.html#ga5f350c294d755e5988a4d1d815770bca">TAT::Tensor::show</a></div><div class="ttdeci">std::string show() const</div><div class="ttdef"><b>Definition:</b> io.hpp:542</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a1d423525b08fa4b1624435798c2be80d"><div class="ttname"><a href="structTAT_1_1Tensor.html#a1d423525b08fa4b1624435798c2be80d">TAT::Tensor::~Tensor</a></div><div class="ttdeci">~Tensor()=default</div></div>
<div class="ttc" id="astructTAT_1_1Singular_html_a92fcbf9f6877a19832fa15b38af050e4"><div class="ttname"><a href="structTAT_1_1Singular.html#a92fcbf9f6877a19832fa15b38af050e4">TAT::Singular::load</a></div><div class="ttdeci">Singular&lt; ScalarType, Symmetry, Name &gt; &amp;&amp; load(const std::string &amp;string) &amp;&amp;</div><div class="ttdef"><b>Definition:</b> tensor.hpp:90</div></div>
<div class="ttc" id="agroup__IO_html_ga020c0be4a859687755aeef9b910d5c1b"><div class="ttname"><a href="group__IO.html#ga020c0be4a859687755aeef9b910d5c1b">TAT::Singular::dump</a></div><div class="ttdeci">std::string dump() const</div><div class="ttdef"><b>Definition:</b> io.hpp:596</div></div>
<div class="ttc" id="agroup__IO_html_ga324fca0e2b2ab0e6e4524bda982788fd"><div class="ttname"><a href="group__IO.html#ga324fca0e2b2ab0e6e4524bda982788fd">TAT::Tensor::data_get</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; data_get(std::istream &amp;)</div><div class="ttdef"><b>Definition:</b> io.hpp:613</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a913bb31e5ca738fb74f646e5512a4c36"><div class="ttname"><a href="structTAT_1_1Tensor.html#a913bb31e5ca738fb74f646e5512a4c36">TAT::Tensor::summary</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; summary(const int root) const</div><div class="ttdef"><b>Definition:</b> tensor.hpp:771</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_acba0ec0802ec95a255a99bc42d94dd1f"><div class="ttname"><a href="structTAT_1_1Tensor.html#acba0ec0802ec95a255a99bc42d94dd1f">TAT::Tensor::transform</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; &amp; transform(Transform &amp;&amp;function) &amp;</div><div class="ttdoc">对张量的每个数据元素做同样的原地的变换</div><div class="ttdef"><b>Definition:</b> tensor.hpp:280</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_a4804ab139acbaa19d5efb0b033653e71"><div class="ttname"><a href="structTAT_1_1Tensor.html#a4804ab139acbaa19d5efb0b033653e71">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor(ScalarType number)</div><div class="ttdoc">创建秩为零的张量</div><div class="ttdef"><b>Definition:</b> tensor.hpp:196</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ad7be591e974161d7c1b5a94082abb937"><div class="ttname"><a href="structTAT_1_1Tensor.html#ad7be591e974161d7c1b5a94082abb937">TAT::Tensor::Tensor</a></div><div class="ttdeci">Tensor()=default</div></div>
<div class="ttc" id="astructTAT_1_1Tensor_html_ab2c9d5865a9866a31a44db38b6aaf5b8"><div class="ttname"><a href="structTAT_1_1Tensor.html#ab2c9d5865a9866a31a44db38b6aaf5b8">TAT::Tensor::split_edge</a></div><div class="ttdeci">Tensor&lt; ScalarType, Symmetry, Name &gt; split_edge(std::map&lt; Name, std::vector&lt; std::tuple&lt; Name, BoseEdge&lt; Symmetry &gt;&gt;&gt;&gt; split, bool apply_parity=false, const std::set&lt; Name &gt; &amp;parity_exclude_name_split={}) const</div><div class="ttdoc">分裂张量的一些边</div><div class="ttdef"><b>Definition:</b> edge_miscellaneous.hpp:110</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_d1f80ff82539b6697abb4a4794b81257.html">TAT</a></li><li class="navelem"><a class="el" href="tensor_8hpp.html">tensor.hpp</a></li>
    <li class="footer">生成于 2020年 十二月 9日 星期三 01:49:45 , 为 TAT使用 
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
